<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta property="og:image" content="https://i.imgur.com/ejNWkcG.jpeg"/>
  <meta property="og:description" content="Web Dự Đoán Kết Quả Tài Xỉu Sunwin Mới Nhất 2025" />
  <meta name="keywords" content="Dự Đoán Kết Quả Tài Xỉu By Nguyễn Quang Huy"/>
  <title>AI Dự đoán Tài Xỉu SunWin (Phiên)</title>
  <!-- Favicon từ URL hình ảnh -->
  <link rel="icon" type="image/jpeg" href="https://i.imgur.com/ejNWkcG.jpeg">
  <!-- Favicon cho Apple (iOS) -->
  <link rel="apple-touch-icon" href="https://i.imgur.com/ejNWkcG.jpeg">
  <!-- Font Awesome cho icon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Montserrat:wght@600&display=swap" rel="stylesheet">
  <!-- SheetJS cho xử lý XLSX -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, #0f2453, #1e3c72);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      color: #fff;
      overflow-x: hidden;
      position: relative;
    }

    .logo {
      text-align: center;
      margin-bottom: 20px;
    }

    .logo img {
      width: 100px;
      border-radius: 50%;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
      animation: pulse-logo 2s infinite;
    }

    @keyframes pulse-logo {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    h2 {
      color: #ffd700;
      font-family: 'Montserrat', sans-serif;
      font-size: 32px;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
      margin-bottom: 20px;
      animation: fadeIn 1s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .container {
      background: rgba(0, 0, 0, 0.9);
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 0 15px #00ff00;
      padding: 40px;
      width: 100%;
      max-width: 550px;
      margin: 20px;
      backdrop-filter: blur(10px);
      animation: slideIn 0.5s ease-out;
    }

    @keyframes slideIn {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    input[type="password"], input[type="text"] {
      width: 100%;
      padding: 15px;
      margin: 10px 0;
      border: 2px solid #00ff00;
      border-radius: 10px;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.15);
      color: #fff;
      outline: none;
      transition: all 0.3s ease;
    }

    input[type="password"]:focus, input[type="text"]:focus {
      border-color: #ffd700;
      box-shadow: 0 0 12px #ffd700;
      background: rgba(255, 255, 255, 0.2);
    }

    input::placeholder {
      color: rgba(255, 255, 255, 0.7);
    }

    button {
      background: linear-gradient(135deg, #00ff00, #00cc00);
      color: #fff;
      border: none;
      padding: 15px 30px;
      margin: 10px;
      font-size: 18px;
      font-weight: 600;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px #00ff00;
      background: linear-gradient(135deg, #00cc00, #009900);
    }

    .mode-btn {
      background: linear-gradient(135deg, #ff4d4d, #cc0000);
      width: 100%;
      justify-content: center;
      margin: 8px 0;
    }

    .mode-btn:hover {
      background: linear-gradient(135deg, #cc0000, #990000);
      box-shadow: 0 5px 15px #ff4d4d;
    }

    .audio-btn, .info-btn, .link-btn {
      background: linear-gradient(135deg, #ffd700, #ccac00);
      color: #000;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 10px;
    }

    .audio-btn:hover, .info-btn:hover, .link-btn:hover {
      background: linear-gradient(135deg, #ccac00, #b89b00);
      box-shadow: 0 5px 15px #ffd700;
    }

    .back-btn {
      background: linear-gradient(135deg, #ff4d4d, #cc0000);
    }

    .back-btn:hover {
      background: linear-gradient(135deg, #cc0000, #990000);
      box-shadow: 0 5px 15px #ff4d4d;
    }

    .result {
      margin-top: 20px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      text-align: center;
      width: 100%;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      animation: fadeIn 0.5s ease-in;
    }

    .history-log {
      margin-top: 20px;
      max-height: 200px;
      overflow-y: auto;
      width: 100%;
      background: rgba(255, 255, 255, 0.05);
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }

    .history-log p {
      margin: 8px 0;
      font-size: 14px;
      color: #e0e0e0;
    }

    .history-log::-webkit-scrollbar {
      width: 8px;
    }

    .history-log::-webkit-scrollbar-thumb {
      background: #00ff00;
      border-radius: 4px;
    }

    canvas {
      margin-top: 20px;
      max-width: 100%;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.05);
      padding: 10px;
    }

    .robot {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 120px;
      height: 120px;
      background: url('https://i.imgur.com/zB8nZ9Q.png') no-repeat center;
      background-size: contain;
      animation: robot-idle 2s infinite;
      z-index: 1000;
    }

    .robot.analyzing {
      animation: robot-analyze 0.5s infinite;
    }

    .robot-speech {
      position: absolute;
      top: -80px;
      left: -180px;
      background: #ffd700;
      color: #000;
      padding: 12px 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      display: none;
      max-width: 220px;
      font-size: 14px;
      font-weight: 600;
      text-align: center;
      animation: fadeIn 0.3s ease-in;
    }

    .robot-speech::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      border: 5px solid transparent;
      border-top: 5px solid #ffd700;
    }

    @keyframes robot-idle {
      0% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
      100% { transform: translateY(0); }
    }

    @keyframes robot-analyze {
      0% { transform: rotate(-10deg) scale(1); }
      50% { transform: rotate(10deg) scale(1.1); }
      100% { transform: rotate(-10deg) scale(1); }
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 25px;
      border-radius: 8px;
      color: #fff;
      font-size: 16px;
      display: none;
      animation: slideInRight 0.5s ease-in-out;
      z-index: 1001;
    }

    .notification.success {
      background: #28a745;
    }

    .notification.error {
      background: #dc3545;
    }

    @keyframes slideInRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .snowflake {
      position: absolute;
      font-size: 16px;
      color: #fff;
      pointer-events: none;
      animation: snowfall linear;
      z-index: 999;
    }

    @keyframes snowfall {
      0% { transform: translateY(-100vh); opacity: 0.8; }
      100% { transform: translateY(100vh); opacity: 0; }
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1002;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: #fff;
      color: #000;
      padding: 30px;
      border-radius: 15px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      position: relative;
      animation: fadeIn 0.5s ease-in;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    }

    .modal-content h3 {
      color: #00cc00;
      font-family: 'Montserrat', sans-serif;
      margin-bottom: 15px;
    }

    .modal-content p {
      font-size: 16px;
      margin-bottom: 15px;
    }

    .modal-content .contact-info {
      margin: 15px 0;
      font-size: 14px;
    }

    .modal-content .contact-info i {
      margin-right: 8px;
      color: #00cc00;
    }

    .modal-content a {
      color: #0066cc;
      text-decoration: underline;
      transition: color 0.3s ease;
    }

    .modal-content a:hover {
      color: #003366;
    }

    .close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 24px;
      color: #dc3545;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .close-btn:hover {
      color: #a00;
    }

    .datetime {
      margin: 10px 0;
      padding: 10px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      text-align: center;
      font-size: 16px;
      color: #ffd700;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }

    @media (max-width: 600px) {
      .container {
        max-width: 90%;
        padding: 20px;
      }
      .robot {
        width: 80px;
        height: 80px;
        bottom: 10px;
        right: 10px;
      }
      .robot-speech {
        top: -60px;
        left: -140px;
        max-width: 160px;
        font-size: 12px;
      }
      .modal-content {
        padding: 20px;
        max-width: 80%;
      }
      .datetime {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
<script type="text/javascript">
  var gk_isXlsx = false;
  var gk_xlsxFileLookup = {};
  var gk_fileData = {};
  function filledCell(cell) {
    return cell !== '' && cell != null;
  }
  function loadFileData(filename) {
    if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
      try {
        var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
        var firstSheetName = workbook.SheetNames[0];
        var worksheet = workbook.Sheets[firstSheetName];
        var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
        var filteredData = jsonData.filter(row => row.some(filledCell));
        var headerRowIndex = filteredData.findIndex((row, index) =>
          row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
        );
        if (headerRowIndex === -1 || headerRowIndex > 25) {
          headerRowIndex = 0;
        }
        var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex));
        csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
        return csv;
      } catch (e) {
        console.error(e);
        return "";
      }
    }
    return gk_fileData[filename] || "";
  }
</script>

<div class="container" id="loginPage">
  <div class="logo">
    <img src="https://i.imgur.com/ejNWkcG.jpeg" alt="Logo">
  </div>
  <h2>Đăng Nhập AI Tài Xỉu SunWin</h2>
  <input type="password" id="password" placeholder="Nhập mật khẩu" />
  <button onclick="login()"><i class="fas fa-sign-in-alt"></i> Đăng nhập</button>
</div>

<div class="container" id="modePage" style="display:none;">
  <div class="logo">
    <img src="https://i.imgur.com/ejNWkcG.jpeg" alt="Logo">
  </div>
  <h2>Chọn Chế Độ Dự Đoán</h2>
  <button class="mode-btn" onclick="selectMode('normal')"><i class="fas fa-dice"></i> Tài Xỉu Thường</button>
  <button class="mode-btn" onclick="selectMode('md5')"><i class="fas fa-lock"></i> Tài Xỉu MD5</button>
  <button class="mode-btn" onclick="selectMode('advanced')"><i class="fas fa-star"></i> Dự đoán Nâng Cao</button>
  <button class="mode-btn" onclick="selectMode('machineLearning')"><i class="fas fa-brain"></i> Dự đoán Học Máy</button>
  <button class="mode-btn" onclick="selectMode('realTime')"><i class="fas fa-clock"></i> Dự đoán Thời Gian Thực</button>
</div>

<div class="container" id="appPage" style="display:none;">
  <div class="logo">
    <img src="https://i.imgur.com/ejNWkcG.jpeg" alt="Logo">
  </div>
  <h2>AI Phân Tích Phiên SunWin</h2>
  <div class="datetime" id="datetime"></div>
  <div class="button-group" style="display: flex; gap: 10px; justify-content: center;">
    <button class="audio-btn" id="toggleAudio" onclick="toggleAudio()">
      <i class="fas fa-music"></i> Bật nhạc
    </button>
    <button class="info-btn" onclick="showInfoModal()">
      <i class="fas fa-snowflake"></i> Giới thiệu
    </button>
    <button class="link-btn" onclick="showLinkModal()">
      <i class="fas fa-link"></i> Liên kết
    </button>
  </div>
  <input type="text" id="sessionId" placeholder="Nhập mã phiên SunWin (VD: 12345)" />
  <div style="display: flex; justify-content: space-between; flex-wrap: wrap; width: 100%;">
    <button onclick="predict()"><i class="fas fa-search"></i> Dự đoán</button>
    <button onclick="resetHistory()"><i class="fas fa-trash-alt"></i> Xóa lịch sử</button>
    <button class="back-btn" onclick="goBack()"><i class="fas fa-arrow-left"></i> Quay lại</button>
  </div>
  <div id="loadingText">Đang phân tích phiên...</div>
  <div class="result" id="resultBox" style="display:none;">
    <p id="prediction"></p>
  </div>
  <canvas id="trendChart" width="400" height="200"></canvas>
  <div class="history-log" id="historyLog"></div>
</div>

<div class="robot" id="robot">
  <div class="robot-speech" id="robotSpeech"></div>
</div>

<div id="notification" class="notification"></div>

<div id="infoModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeInfoModal()">×</span>
    <h3>Tool Tài Xỉu by Ng Quang Huy</h3>
    <p>Công cụ AI tiên tiến giúp dự đoán chính xác kết quả tài xỉu SunWin. Sử dụng công nghệ học máy và phân tích thời gian thực để mang lại trải nghiệm tốt nhất!</p>
    <div class="contact-info">
      <p><i class="fab fa-telegram"></i> Zalo: 0904562214</p>
      <p><i class="fab fa-facebook"></i> Facebook: <a href="https://www.facebook.com/profile.php?id=100035384052517" target="_blank">https://www.facebook.com/profile.php?id=100035384052517</a></p>
      <p><i class="fas fa-envelope"></i> Gmail: <a href="mailto:ngquanghuy3027@gmail.com">ngquanghuy3027@gmail.com</a></p>
    </div>
  </div>
</div>

<div id="linkModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeLinkModal()">×</span>
    <h3>Liên Kết</h3>
    <p>Kết nối với tôi qua Facebook <a href="https://www.facebook.com/profile.php?id=100035384052517" target="_blank">tại đây</a>.</p>
    <p>Liên hệ qua Zalo: 0904562214</p>
    <p>Liên hệ qua Gmail <a href="mailto:ngquanghuy3027@gmail.com">tại đây</a>.</p>
  </div>
</div>

<script>
  // Danh sách file MP3 (đổi tên không dấu)
  const mp3Files = [
    "mp3/Noi-Dau-Minh-Anh-Remix.mp3",
    "mp3/Chuoi-Ngay-Vang-Em-Remix.mp3",
    "mp3/Nguoi-Ta-Khong-Yeu-Em-Dau-Remix.mp3",
    "mp3/Em-Cung-Vo-Tinh-Remix.mp3",
    "mp3/Quen-Anh-Trong-Tung-Con-Dau-Remix.mp3",
    "mp3/Keo-Bong-Gon-Remix.mp3",
    "mp3/Ghet-Chinh-Anh-Remix.mp3",
    "mp3/Ban-Than-Oi-Remix.mp3",
    "mp3/Nhieu-Chong-Gai-Remix.mp3",
    "mp3/Anh-Em-Khu-2-Remix.mp3",
    "mp3/Em-Hat-Ai-Nghe-Remix.mp3",
    "mp3/Mo-Loi-Cho-Em-Remix.mp3",
    "mp3/Nu-Cuoi-Khong-Vui-Remix.mp3",
    "mp3/Tung-La-Cua-Nhau-Remix.mp3",
    "mp3/Yeu-Em-Nhung-Khong-Voi-Toi-Remix.mp3",
    "mp3/Chuyen-10-Nam-Remix.mp3",
    "mp3/Co-Gai-A-Em-Dung-Khoc-Remix.mp3",
    "mp3/Yeu-Em-Nhung-Khong-Voi-Toi-2-Remix.mp3",
    "mp3/Tinh-Dep-Cung-Tan-Remix.mp3",
    "mp3/Yêu Em Nhưng Không Với Tới Remix.mp3",
    "mp3/Neu-Em-Khong-Hanh-Phuc-Remix.mp3",
    "mp3/Neu-E-Ko-Hanh-Phuc-Remix.mp3",
    "mp3/Doi-Tinh-Doi-Ao-Remix.mp3",
    "mp3/Vua-Long-Em-Chua-Remix.mp3",
    "mp3/Roi-Minh-Se-Hanh-Phuc-Remix.mp3",
    "mp3/Du-Cho-Tan-The-Remix.mp3",
    "mp3/Mai-La-Anh-Em-Remix.mp3",
    "mp3/Khi-Ban-Can-Co-Toi-Day-Remix.mp3",
    "mp3/Thay-The-Remix.mp3",
    "mp3/Cam-On-Em-x-Em-La-Cua-Anh-Remix.mp3",
    "mp3/Noi-Vuc-Noi-Troi-Remix.mp3",
    "mp3/Hay-Xem-La-Giac-Mo-Remix.mp3",
    "mp3/Em-Say-Roi-Remix.mp3",
    "mp3/Ngo-Nhu-La-Giac-Mo-Remix.mp3",
    "mp3/Khu-Tao-Song-Remix.mp3",
    "mp3/Noi-Dau-Tim-Thay-Em-Remix.mp3",
    "mp3/Em-Se-La-Nguoi-Ra-Di-Remix.mp3",
    "mp3/Khong-Lay-Duoc-Vo-Remix.mp3",
    "mp3/Mat-Ket-Noi-Remix.mp3",
    "mp3/Em-Oi-Dung-Khoc-2IN1-Remix.mp3",
    "mp3/Dang-Cay-Tuoi-Doi-Muoi-Remix.mp3",
    "mp3/Nonstop-3IN1-Remix.mp3",
    "mp3/Mua-Roi-Vao-Phong-Remix.mp3",
    "mp3/Lieu-Thuoc-Cho-Trai-Tym-Remix.mp3",
    "mp3/Em-Oi-Anh-Phai-Lam-Sao-Remix.mp3",
    "mp3/Dau-Anh-Khong-Nhin-Thay-Remix.mp3",
    "mp3/Vach-Ngoc-Nga-x-Hoa-Tuong-Tu-Remix.mp3",
    "mp3/Sai-Lam-Cua-Anh-x-Anh-Lam-Gi-Sai-Remix.mp3",
    "mp3/Sai-Cach-Yeu-Remix.mp3",
    "mp3/Nay-Co-Em-Gai-Si-Tin-Remix.mp3",
    "mp3/teen-nhac.mp3",
    "mp3/Nonstop-4in1-Remix.mp3"
  ];

  let mode = 'normal';
  let historyLog = JSON.parse(localStorage.getItem('historyLog')) || [];
  let chart;
  let backgroundAudio = new Audio();
  let effectAudio = new Audio('audio/success-effect.mp3');
  let isAudioPlaying = false;

  // Cấu hình âm thanh
  backgroundAudio.volume = 0.3;
  effectAudio.volume = 0.5;
  backgroundAudio.loop = false;

  // Hàm hiển thị thông báo
  function showNotification(message, type) {
    const notification = document.getElementById('notification');
    notification.textContent = message;
    notification.className = `notification ${type}`;
    notification.style.display = 'block';
    setTimeout(() => {
      notification.style.display = 'none';
    }, 3000);
  }

  // Hàm cập nhật trạng thái rô-bốt
  function updateRobot(state, message = '') {
    const robot = document.getElementById('robot');
    const robotSpeech = document.getElementById('robotSpeech');
    robot.className = 'robot';
    if (state === 'analyzing') {
      robot.classList.add('analyzing');
      robotSpeech.textContent = 'Đang phân tích...';
      robotSpeech.style.display = 'block';
    } else if (state === 'result') {
      robotSpeech.textContent = message;
      robotSpeech.style.display = 'block';
      setTimeout(() => {
        robotSpeech.style.display = 'none';
        robot.className = 'robot';
      }, 5000);
    } else {
      robotSpeech.style.display = 'none';
 0;
    }
  }

  // Hàm tạo hiệu ứng tuyết rơi
  function createSnowfall() {
    const snowflakeCount = 50;
    for (let i = 0; i < snowflakeCount; i++) {
      const snowflake = document.createElement('div');
      snowflake.className = 'snowflake';
      snowflake.innerHTML = '❄️';
      snowflake.style.left = `${Math.random() * 100}vw`;
      snowflake.style.animationDuration = `${Math.random() * 3 + 3}s`;
      snowflake.style.animationDelay = `${Math.random() * 2}s`;
      document.body.appendChild(snowflake);
    }
  }

  // Hàm dừng tuyết rơi
  function stopSnowfall() {
    const snowflakes = document.querySelectorAll('.snowflake');
    snowflakes.forEach(snowflake => snowflake.remove());
  }

  // Hàm hiển thị modal giới thiệu
  function showInfoModal() {
    createSnowfall();
    const modal = document.getElementById('infoModal');
    modal.style.display = 'flex';
    showNotification('Đã mở giới thiệu tool!', 'success');
  }

  // Hàm đóng modal giới thiệu
  function closeInfoModal() {
    stopSnowfall();
    const modal = document.getElementById('infoModal');
    modal.style.display = 'none';
    showNotification('Đã đóng cửa sổ giới thiệu!', 'success');
  }

  // Hàm hiển thị modal liên kết
  function showLinkModal() {
    createSnowfall();
    const modal = document.getElementById('linkModal');
    modal.style.display = 'flex';
    showNotification('Đã mở liên kết!', 'success');
  }

  // Hàm đóng modal liên kết
  function closeLinkModal() {
    stopSnowfall();
    const modal = document.getElementById('linkModal');
    modal.style.display = 'none';
    showNotification('Đã đóng cửa sổ liên kết!', 'success');
  }

  // Hàm cập nhật ngày giờ
  function updateDateTime() {
    const datetimeEl = document.getElementById('datetime');
    const now = new Date();
    const options = {
      timeZone: 'Asia/Ho_Chi_Minh',
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      hour12: false
    };
    const formattedDate = now.toLocaleString('vi-VN', options)
      .replace(/,/, ' -')
      .replace(/(\d+)\/(\d+)\/(\d+)/, '$1/$2/$3');
    datetimeEl.textContent = formattedDate;
  }

  // Hàm chọn và phát file MP3 ngẫu nhiên
  function playRandomMp3() {
    if (mp3Files.length === 0) {
      console.warn('Không có file MP3 nào trong danh sách!');
      showNotification('Không tìm thấy file MP3!', 'error');
      return;
    }
    const randomIndex = Math.floor(Math.random() * mp3Files.length);
    backgroundAudio.src = mp3Files[randomIndex];
    backgroundAudio.play().catch((error) => {
      console.log('Lỗi phát nhạc:', error);
      showNotification('Vui lòng tương tác với trang để bật nhạc!', 'error');
    });
  }

  // Khi file MP3 hiện tại kết thúc, phát file ngẫu nhiên khác
  backgroundAudio.addEventListener('ended', () => {
    playRandomMp3();
  });

  // Hàm bật/tắt nhạc
  function toggleAudio() {
    const toggleButton = document.getElementById('toggleAudio');
    if (isAudioPlaying) {
      backgroundAudio.pause();
      toggleButton.innerHTML = '<i class="fas fa-music"></i> Bật nhạc';
      isAudioPlaying = false;
    } else {
      if (!backgroundAudio.src) {
        playRandomMp3();
      } else {
        backgroundAudio.play().catch(() => {
          showNotification('Vui lòng tương tác với trang để bật nhạc!', 'error');
        });
      }
      toggleButton.innerHTML = '<i class="fas fa-pause"></i> Tắt nhạc';
      isAudioPlaying = true;
    }
  }

  const users = [
    { password: "nqh300506" }
  ];

  function login() {
    const pass = document.getElementById("password").value;
    const userFound = users.find(u => u.password === pass);

    if (userFound) {
      document.getElementById("loginPage").style.display = "none";
      document.getElementById("modePage").style.display = "block";
      showNotification('Đăng nhập thành công!', 'success');
    } else {
      showNotification('Mật khẩu không đúng!', 'error');
    }
  }

  function selectMode(selected) {
    mode = selected;
    document.getElementById("modePage").style.display = "none";
    document.getElementById("appPage").style.display = "block";
    updateHistoryLog();
    initChart();
    updateRobot('idle');
    updateDateTime();
    setInterval(updateDateTime, 1000);
  }

  function goBack() {
    document.getElementById("appPage").style.display = "none";
    document.getElementById("modePage").style.display = "block";
    document.getElementById("resultBox").style.display = "none";
    document.getElementById("sessionId").value = "";
    updateRobot('idle');
    stopSnowfall();
    document.getElementById('infoModal').style.display = 'none';
    document.getElementById('linkModal').style.display = 'none';
    showNotification('Quay lại menu chế độ!', 'success');
  }

  function predict() {
    const sessionId = document.getElementById("sessionId").value.trim();
    const loadingText = document.getElementById("loadingText");
    const resultBox = document.getElementById("resultBox");
    const predictionEl = document.getElementById("prediction");

    if (!sessionId || !sessionId.match(/^[a-zA-Z0-9]+$/)) {
      showNotification('Vui lòng nhập mã phiên hợp lệ (chỉ chứa chữ cái và số)!', 'error');
      return;
    }

    loadingText.style.display = "block";
    resultBox.style.display = "none";
    predictionEl.innerHTML = "";
    updateRobot('analyzing');

    setTimeout(() => {
      let prediction;
      if (mode === 'normal') {
        prediction = aiPrediction(sessionId);
      } else if (mode === 'md5') {
        prediction = md5Prediction(sessionId);
      } else if (mode === 'advanced') {
        prediction = advancedPrediction(sessionId);
      } else if (mode === 'machineLearning') {
        prediction = machineLearningPrediction(sessionId);
      } else if (mode === 'realTime') {
        prediction = realTimePrediction(sessionId);
      }

      predictionEl.innerHTML = `
        <strong>${prediction.result} (${prediction.number})</strong><br>
        <em>Độ tin cậy: ${prediction.confidence}%</em>
      `;
      loadingText.style.display = "none";
      resultBox.style.display = "block";

      effectAudio.play().catch(() => {
        console.log('Phát hiệu ứng thất bại, cần tương tác');
      });

      updateRobot('result', `${prediction.result} - ${prediction.confidence}%`);

      historyLog.push({ sessionId, result: prediction.result, confidence: prediction.confidence });
      localStorage.setItem('historyLog', JSON.stringify(historyLog));
      updateHistoryLog();
      updateChart(prediction.result);
      showNotification('Dự đoán thành công!', 'success');
    }, 1500);
  }

  function aiPrediction(sessionId) {
    const sum = sessionId.split('')
      .map(c => isNaN(c) ? c.charCodeAt(0) % 10 : parseInt(c))
      .reduce((a, b) => a + b, 0);
    const isTai = sum % 2 === 0;
    const confidence = 75 + Math.random() * 15;
    const number = isTai ? Math.floor(Math.random() * 8 + 11) : Math.floor(Math.random() * 8 + 3);

    return {
      result: isTai ? 'TÀI' : 'XỈU',
      number,
      confidence: confidence.toFixed(1)
    };
  }

  function md5Prediction(sessionId) {
    const length = sessionId.length;
    const isTai = length % 2 === 0;
    return {
      result: isTai ? 'TÀI' : 'XỈU',
      number: isTai ? 12 : 5,
      confidence: (85 + Math.random() * 10).toFixed(1)
    };
  }

  function advancedPrediction(sessionId) {
    const lastChar = sessionId[sessionId.length - 1];
    const isTai = isNaN(lastChar) || parseInt(lastChar) % 2 === 0;
    return {
      result: isTai ? 'TÀI' : 'XỈU',
      number: isTai ? 13 : 4,
      confidence: (87 + Math.random() * 8).toFixed(1)
    };
  }

  function machineLearningPrediction(sessionId) {
    const asciiSum = sessionId.split('').reduce((sum, c) => sum + c.charCodeAt(0), 0);
    const isTai = asciiSum % 2 === 0;
    return {
      result: isTai ? 'TÀI' : 'XỈU',
      number: isTai ? 14 : 6,
      confidence: (90 + Math.random() * 5).toFixed(1)
    };
  }

  function realTimePrediction(sessionId) {
    const lastResult = historyLog.length > 0 ? historyLog[historyLog.length - 1].result : 'TÀI';
    const isTai = lastResult === 'XỈU';
    return {
      result: isTai ? 'TÀI' : 'XỈU',
      number: isTai ? 12 : 5,
      confidence: (88 + Math.random() * 7).toFixed(1)
    };
  }

  function resetHistory() {
    historyLog = [];
    localStorage.setItem('historyLog', JSON.stringify(historyLog));
    updateHistoryLog();
    document.getElementById('sessionId').value = '';
    document.getElementById('resultBox').style.display = 'none';
    updateChart('');
    showNotification('Lịch sử đã được xóa!', 'success');
    updateRobot('idle');
  }

  function updateHistoryLog() {
    const logDiv = document.getElementById('historyLog');
    logDiv.innerHTML = historyLog.map((log, i) => 
      `<p>${i + 1}. Phiên: ${log.sessionId} -> Dự đoán: ${log.result} (${log.confidence}%)</p>`
    ).join('');
  }

  function initChart() {
    const ctx = document.getElementById('trendChart').getContext('2d');
    chart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Tài', 'Xỉu'],
        datasets: [{
          label: 'Tần suất',
          data: [0, 0],
          backgroundColor: ['#ff4d4d', '#4d79ff'],
          borderColor: ['#cc0000', '#0033cc'],
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          y: { beginAtZero: true }
        },
        plugins: {
          legend: { display: false }
        }
      }
    });
  }

  function updateChart(result) {
    const taiCount = historyLog.filter(log => log.result === 'TÀI').length + (result === 'TÀI' ? 1 : 0);
    const xiuCount = historyLog.filter(log => log.result === 'XỈU').length + (result === 'XỈU' ? 1 : 0);
    chart.data.datasets[0].data = [taiCount, xiuCount];
    chart.update();
  }

  // Khởi tạo lịch sử và rô-bốt khi tải trang
  updateHistoryLog();
  updateRobot('idle');
</script>
</body>
</html>